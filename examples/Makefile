# Copyright (c) M. Broek, 1997-2001
# $Id$

include ../Makefile.global

SRCS		= endian.c
HDRS		= endian.h
OBJS		= endian.o
OTHER		= Makefile header.txt footer.txt menus-le.tar menus-be.tar \
		  txtfiles-en.tar templates-en.tar templates-es.tar templates-de.tar \
		  templates-nl.tar

#####################################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:		endian

endian:		${OBJS} ${LIBS}
		${CC} -o endian ${OBJS} ${LIBS}
		strip endian

install:	all
		@if [ ! -f ${ETCDIR}/header.txt ]; then \
			${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 header.txt ${ETCDIR} ; \
			echo "${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 header.txt ${ETCDIR}" ; \
		fi
		@if [ ! -f ${ETCDIR}/footer.txt ]; then \
			${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 footer.txt ${ETCDIR} ; \
			echo "${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 footer.txt ${ETCDIR}" ; \
		fi
		@if [ ! -f ${PREFIX}/english/menus/main.mnu ]; then \
			tar xfC menus-`./endian`.tar ${PREFIX}/english/menus ; \
			echo "tar xfC menus-`./endian`.tar ${PREFIX}/english/menus" ; \
			echo "Installed default english menus" ; \
		fi
		@if [ ! -f ${PREFIX}/english/txtfiles/main.ans ]; then \
			tar xfC txtfiles-en.tar ${PREFIX}/english/txtfiles ; \
			echo "Installed default English txtfiles" ; \
		fi
		@if [ ! -f ${PREFIX}/english/macro/html.tic ]; then \
			tar xfC templates-en.tar ${PREFIX}/english/macro ; \
			echo "Installed default English macro files" ; \
		fi
		@if [ ! -f ${PREFIX}/german/macro/html.tic ]; then \
			tar xfC templates-de.tar ${PREFIX}/german/macro ; \
			echo "Installed default German macro files" ; \
		fi
		@if [ ! -f ${PREFIX}/dutch/macro/html.tic ]; then \
			tar xfC templates-nl.tar ${PREFIX}/dutch/macro ; \
			echo "Installed default Dutch macro files" ; \
		fi

clean:
		rm -f endian *.o *.h~ *.c~ core filelist Makefile.bak

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ;do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
	@rm -f Makefile.bak; \
	mv Makefile Makefile.bak; \
	sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
	${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
	${ECHO} '# Dependencies generated by make depend' >>Makefile; \
	for f in ${SRCS}; \
	do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[  ]*include[      ]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
	done; \
	${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
endian.o: endian.h
# End of generated dependencies
