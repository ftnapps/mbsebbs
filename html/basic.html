<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=ISO 8859-1">
<META http-equiv="Content-Style-Type" content="text/css">
<META name="author" lang="en" content="Michiel Broek">
<META name="copyright" lang="en" content="Copyright Michiel Broek">
<META name="description" lang="en" content="MBSE BBS Manual">
<META name="keywords" lang="en" content="MBSE BBS, MBSE, BBS, manual, fido, fidonet, gateway, tosser, mail, tic, mailer">
<TITLE>MBSE BBS basic installation.</TITLE>
<LINK rel=stylesheet HREF="manual.css">
</HEAD>
<BODY>
<BLOCKQUOTE>
<h5>Last update 29-Dec-2001</h5>
<P>&nbsp;<P>

<h1>MBSE BBS Basic Installation</h1>

<h3>Introduction.</h3>
<p>
Before you compile and install MBSE BBS you must first setup the basic
environment. If you don't do this, things will fail. 
<P>&nbsp;<p>

<h3>Step 1: planning the filesystems.</h3>
<p>
MBSE BBS is default installed in <b>/opt/mbse</b>. The default filesystem
layout looks like this:<br>
<pre>
/opt/mbse                      Default MBSE_ROOT
/opt/mbse/bin                  Binaries
/opt/mbse/doc                  Generated sitedocs
/opt/mbse/dutch/macro          N/A
/opt/mbse/dutch/menus          Dutch menu files
/opt/mbse/dutch/txtfiles       Dutch ANSI files
/opt/mbse/english/macro        Default english macros, not yet.
/opt/mbse/english/menus        Default english menus
/opt/mbse/english/txtfiles     Default english ANSI files
/opt/mbse/etc                  System configuration files
/opt/mbse/fdb                  Files database
/opt/mbse/ftp                  Default FTP root
/opt/mbse/galego/macro         N/A
/opt/mbse/galego/menus         Galego menu files
/opt/mbse/galego/txtfiles      Galego ANSI files
/opt/mbse/home                 Users homedirectories
/opt/mbse/home/bbs             Newuser account
/opt/mbse/html                 HTML documentation
/opt/mbse/italian/macro        N/A
/opt/mbse/italian/menus        Italian menu files
/opt/mbse/italian/txtfiles     Italian ANSI files
/opt/mbse/log                  MBSE BBS logfiles
/opt/mbse/magic                Magic filerequest names
/opt/mbse/sema                 Semafore files
/opt/mbse/spanish/macro        N/A
/opt/mbse/spanish/menus        Spanish menu files
/opt/mbse/spanish/txtfiles     Spanish ANSI files
/opt/mbse/tmp                  Temp directory
/opt/mbse/tmp/arc              Temp archiver directory
/opt/mbse/var                  Var root
/opt/mbse/var/badtic           Bad TIC files
/opt/mbse/var/bso              Binkley Style Outbound directory
/opt/mbse/var/bso/inbound      Protected inbound directory
/opt/mbse/var/bso/outbound     Default outbound directory
/opt/mbse/var/bso/unknown      Unprotected inbound directory
/opt/mbse/var/mail             JAM messagebase root
/opt/mbse/var/mail/badmail     Bad echomail
/opt/mbse/var/mail/dupmail     Duplicate echomail
/opt/mbse/var/msgs             *.msgs netmail directory (not yet in use).
/opt/mbse/var/nodelist         Nodelists
/opt/mbse/var/ticqueue         Queue for TIC files
</pre>
<p>
Don't use UMSDOS or SAMBA filesystems for the bbs, stick by the standard Linux
filesystems (ext2 or reiserfs) or ufs if you use FreeBSD.
If you intent to make your bbs also accessible
by FTP and WWW you must create the directory structure under the ftp user
behind the pub directory. Read <a href="misc/ftpserver.html">the
ftp server</a> doc for details. If you don't follow these guidlines, you
will run into trouble later and have to spend a lot of time in correcting
this error.
<P>&nbsp;<p>

<h3>Step 2: Running the installation script.</h3>
<p>
If you are upgrading, proceed with step 4. If not, follow the next steps
very carefully!
The installation script must be run by root. It checks if there is a
previous or failed installation on your system. If that's so the script will
not run. In other words, you can only run this script once. The script makes
backup copies of the system files it changes, these files will get the
extension <strong>.mbse</strong> To run the installation script you need
the archive <strong>mbbsebbs-0.33.nn.tar.gz</strong>.
Unpack this archive on your system, in /tmp will do fine:
<pre>
cd /tmp
tar xfvz /path/to/the/mbsebbs-0.33.nn.tar.gz
</pre>
To start the script type:
<pre>
cd mbsebbs-0.33.nn
bash ./SETUP.sh
</pre>
Yes, use <b>bash</b> as shell here. On some systems root doesn't use  bash
as login shell, calling the script with bash forces the use of bash.
The script does the following:
<ol>
 <li>Create the group <strong>bbs</strong>
 <li>Create the user <strong>mbse</strong>
 <li>Create a <strong>.profile</strong> for user <strong>mbse</strong>
 <li>Create and set owner of directory tree under /opt/mbse
</ol>
Then the script will ask you to give a password for user <strong>mbse</strong>
This password is for system maintenance and for you to make changes to the
bbs. You will need that frequently but you should not make that password
easy to guess of course. The script will then continue again:
<ol start="5">
 <li>The user <strong>bbs</strong> is added.
 <li>The password will be removed from user <strong>bbs</strong> This action
will make changes in /etc/shadow (if you have that) otherwise in /etc/passwd.
On FreeBSD it uses other tools to modify the master database.
 <li>If they don't exist in the file /etc/services the services fido, tfido
and binkp will be added.
 <li>If they don't exist in the file /etc/inetd.conf the internet protocols
for the mailer will be added. The <strong>inetd</strong> is restarted to
activate the changes.
</ol>
<p>&nbsp;<p>

<h3>Step 3: Check the basic installation</h3>
<p>
The last screen of the script is about sanity checks. Perform those checks!
If something is wrong, now is the time to fix it. Don't panic and remember
the backups of the system files that are changed are in /etc with the 
extension <strong>.mbse</strong> i.e: those were the original files.
If everythings is allright, then remove the directory /tmp/mbsebbs-0.33.nn:
<pre>
cd /tmp
rm -Rf mbsebbs-0.33.nn
</pre>
<p>&nbsp;<p>

<h3>Step 4: Install the basic packages.</h3>
<p>
Login as user <b>mbse</b>. Yes, very important, <b>login as user mbse</b>.
While in the home directory unpack the distribution archives:
<pre>
tar xfvz /path/to/mbsebbs-0.33.nn.tar.gz
</pre>
You now have the subdirectory with sources in the right place. 
Next build the binaries and install them using the folowing commands:
<pre>
cd ~/mbsebbs-0.33.nn
./configure
make
su        <b>important, do not use "su -"</b>
password: <em>enter root password here</em>
make install
exit
</pre>
The last part of the installation procedure shows you the location of the bbs
startup script that is added to your system.  Because this is your first
time installation, example menus, textfiles and some databases are installed. 
If they already exist on your systems (when you do an upgrade) they
will not be installed again.
<p>
Now you must start the <b>mbtask</b> daemon by hand by typing <b>/opt/mbse/bin/mbtask</b>.
Check the file <b>/opt/mbse/log/mbtask.log</b> for startup problems. You may notice that
the program <b>mbcico</b> is started everytime, this is not a problem, it simply doesn't work right
now because you haven't configured anything yet. The first time <b>mbtask</b> is
started on your system it will create a lot of new configuration files with
default settings.
<p>&nbsp;<p>

<h3>Step 5: (RedHat) startup problems.</h3>
<p>
From RedHat 6.1 (not the older versions) the behaviour of the 
<strong>su</strong> is changed. This may be true for other distributions since
the end of 1999 and for Mandrake as well. The file <code>/etc/rc.d/init.d/mbsed</code> that is 
created by the setup script is different then before. The new command
is <strong>su -</strong> instead of simply <strong>su</strong>. It might be
that other new distributions also need the extra minus sign. If that's the
case, please let me know and tell me how I can test what version it is. 
<p>&nbsp;<p>

<h3>Step 6: ready.</h3>
<p>
Now the basic environment is finished, the next thing is to <a href="install.html">install</a>
the scripts, examples and configuration.
<P>&nbsp;<P>
<a href="index.htm"><img SRC="images/b_arrow.gif" ALT="Back to Index" BORDER=0 width="33" height="35" ></a>
<a href="index.htm">Back to Index</a>

</blockquote>
</body>
</html>
