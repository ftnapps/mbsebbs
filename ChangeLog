$Id$


v0.50.0		03-Oct-2003 - 09-Feb-2004

	general:
                Added menu setup switches for doors: Singe user door and
                hidden from lists.
                Make dist now creates bzip2 archives.
                Two html pages are now under control of configure.
                The configure scripts shows the use of zlib compression for
                Hydra and Binkp.
                Updated all documentation to validate html makeup.
                Added installation support for Gentoo Linux, contributed by
                Capitán X.
                Since this version Posix threads are being used, please let
                me know if this doesn't compile on you system.
                All Makefiles do not strip the binaries anymore, the binaries
                are stripped during make install only. This allows to run the
                not yet installed binaries under debuggers.
                The configure script has a --enable-debugging option so that
                all code can be compiled to let it run under debuggers. Not
                usefull for production systems.
                This version had a lot of testing using valgrind. Most errors
                were minor problems.
                Added French language file created by Francois Thunus. This
                translation is not yet complete.
                Cleanup in main makefile, added help.
                Revised configure and all Makefiles for better support of
                linking with threads libraries.
                Changed endian tests using the configure script.
                Upgraded to new released ftscprod.008
                Added setup option per node to disable the binkp/1.1 protocol.
                Added new binkp/1.1 driver.
                In all sources replaced the usleep function with the msleep
                function. The usleep function will become obsolete someday.
		Incoming and outgoing telnet (ITN) sessions finally works.

        upgrade:
                If you don't have any personal archivers, then remove
                ~/etc/archiver.data and start mbsetup to recreate the
                archivers setup.
                If you didn't change anything of the language defaults then
                delete /opt/mbse/etc/language.data and run mbsetup to create
                a new language.data including the french setup.
                Check setting 7.x.3.18 for each node. If you know the node uses
                Irex between 2.24 and 2.29 then set this to Yes or you won't
                have good sessions without files with this mailer. Sessions
                with Irex that do transfer some file are Ok.

        libclcomm:
                Fixed a small (not harmfull) buffer overlapped copy detected
                by valgrind.

        libcommon:
                A small fix in printable log function.
                Added a safety check for the TCP registrate function to prevent
                stale TCP/IP mailer counts.
                Fixed a forgotten fclose in proglock.
                Allows node locking with zero bytes lockfiles created by some
                other OS when enabled in the setup.
                The attach function now checks if a file is already attached.
                In execute and execsh on Linux systems sync() is called before
                and after running the external program to make sure diskbuffers
                are committed. Also added a 300 ms pause.
                Added a milliseconds timer.
                Code cleanup.

        libmsgbase:
                In JAM_Open replaced a strcpy with memmove.
                Fixed invalid memory read/write in Msg_Link.

        libdbase:
                Code cleanup in dbdupe.

        libnodelist:
                Fixed a small memory leak.

        mbsebbs:
                The whoson list displays the doorname if set in the menus.
                If a door is single user and the door is in use, the second
                user can't start the door but gets a message about this
                situation.
                Fixed a bug where the bbs goes into a loop after idle timeout
                during login (and maybe in other situations).
                Fixed chat debug logging to only log to the debug.log file.
                Posted netmail messages now support CC: lines. The CC: lines
                should be the first lines of the message in the format:
                CC: Michiel Broek 2:280/28 
                The Carbon Copied messages are marked with original sender.
                Fixed small memory leak.
                Fixed posting to local/echomail areas from bbs users.
		A lot of small fixes for problems found with valgrind.

        mbsetup:
                Added menu settings for single user door and hide door. Added
                setting for the door name in the menus and removed the never
                used password for the menu (Was only present in the setup).
                In node editor, fixed error message when there was no more
                room for new nodes to point to the right menus.
                Added support for tar compressed archives.
                Changed all fidonet domain names to maximum 8 characters so
                that we now follow the FTSC specs.
                Removed binkp CRC settings.
                Fixed a unitialized unlink call in nodes close.
                Fixed unclosed tempfile.
                Fixed several small memory leaks.
                Added default record for french language. 
                Added setting in menu 1.14 to allow zero bytes lockfiles
                created by another OS.
                Added setting in menu 7.x.3.18 to disable the use of binkp/1.1
                protocol per node.
                Corrected a spelling error (thanks Vince).
                Removed global setup screen for the ftp server.
                Reorganised menu 1.4 screen 1 and 2.
                Added settings for T-Mail filebox paths in the second screen
                of menu 1.4.
                Clearing the working message is now only done by the keyboard
                read function.
                In several menu items added range check for integer values.
                In global main aka setup, added check if a domain name is
                present.
                Updates to the database is now shown to the user.

        mbcico:
                Added Hydra zlib compressed data blocks using the idea of Alex
                Shakhaylo. The compression will transfer some files about twice
                as fast as without compression.
                Changed signal handlers to better detect broken TCP links.
                Changed two inbound logmessages to debug level.
                All internal references to tfido port changed to telnet port
                because we now default to telnet port 23 for ITN calls.
                Dropped binkp CRC support because it will be incompatible with
                future extensions.
                Fixed a small memory leak.
                New binkp/1.1 driver. Check the upgrade for your Irex links.
                In case of troubles please report these.
                Added support for T-Mail fileboxes, partly written and info
                provided by Przemyslaw Kwiatkowski (2:480/127).
                Removed the check to disable calling points.
                Added a check to see if we get a URL to call other systems.
                If nodelist info fails, increase error counter in steps of 10.
                Fixed nodelocks during session handshake after many years. The
                problem showed only when mbcico was used together with a mailer
                on a different OS. When a aka is busy, the aka is now dropped.
                When all akas are busy, a session is impossible and the session
                is refused. Thanks to Przemyslaw Kwiatkowski for finding and
                documenting this bug.
                The total session avg cps is now corrected with the two seconds
                session close delay time.
                Added PLZ compression option to binkp.
                Added telnet input and output filters so we can now call and
                answer telnet (ITN) sessions.

        mbfile:
                When the areanumber with the adopt command was not given, the
                help is displayed instead of trying area 0 that doesn't exist.
                With the file move, adopt and import command if the file
                already exists in the destination area, the action is refused.
                Added mbfile sort <area> command. Files are case insensitive
                sorted on the long filename. After sort the indexes are rebuild.
                Fixed some logging that should have been debug logging.
                Fixed a uninitialized memory pointer in the index command.
                Fixed a 3 forgotten file closes in mbfile list.
                Removed sync calls that are now in execute.

        mbfido:
                Changed two logmessages to debug level.
                Fixed a some small memory leaks.
                With scannews after a GROUP command when authorisation was
                asked we did not perform a login.
                Removed sync calls that are now in execute.

        mbtask:
                The ping function now runs in a separate thread.
                Changed some ping timer logic.
                Added a "secret" commandline parameter to allow mbtask to run
                under control of debuggers.
                The client command server runs in a separate thread.
                Fixed some small memory leaks which had no effect on long term
                running of mbtask, only leaks during program stop.
                Moved the scheduler in a thread.
                Rewrote shutdown procedure to make it more portable.
                Removed default settings for the ftp server.
                Added support for T-Mail fileboxes.
                Will call points if a call method is available.

        mbout:
                Fixed several memory leaks.
                Poll, remove poll and request failed to points which had no
                point directory in the outbound, now the directory is created.
                Added support for T-Mail fileboxes.

        mbindex:
                Fixed a forgotten file close.

        mball:
                Fixed 2 forgotten fclose functions.

        mbuser:
                Fixed a forgotten file close when nothing was done.

        mbmon:
                Fixed a minor problem with an uninitialized array.

        mbdiff:
                Removed sync calls that are now in execute.

        mbpasswd:
                Fixed a small memory leak.

	mbuseradd:
		Now logs to syslog instead of stderr.

        script:
                Added install scripts for Gentoo.
                Changed all init scripts to allow the slower stopping of mbtask
                For the latest Slackware distros a setup script for pkgtool is
                added. Most other distro's don't need this.
                Dropped support for Slackware pre 7.0. 
                Changed startup scripts for NetBSD.
                Fixed NetBSD init script
                All init scripts now clean the ~/var/run directory and start
                the bbs allways so that the bbs will try to start after a power
                failure.
                New scripts are installed with an extension of .new, you need
                to check yourself if you can use them to replace your own
                possible modified scripts.
                Updated the hatch script to abort if it's not configured.
                If the user skips to hatch a file, the questions for the magic
                and replace command are not shown anymore.
		Dropped support for RedHat and Mandrake pre 6.1.

        lang:
                Added language prompts 20, 21 and 22.

        examples:
                Updated English and Spanish menus with the new door settings.
                Fixed some spelling errors in the Dutch templates.
                Updated file menus, added View File command.
                Changed Dutch newfiles template file.

        html:
                Removed the outdated ftsc documents, www.ftsc.org is the place
                to look for them
                Added upgrade procedure.

