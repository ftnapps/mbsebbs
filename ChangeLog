$Id$

				MBSEBBS History.

v0.35.01	05-Jun-2002



v0.33.21	04-Jun-2002

		This is the final release of the 0.33.20 development version.


v0.33.20        10-Feb-2002 - 04-Jun-2002

	upgrade:
		Remove /opt/mbse/etc/safe.data
		Compile sources and install binaries. Restart the BBS.
		Enter mbsetup, this will upgrade the databases.
		Go into global configuration, exit and save, this will update
		the main configuration (add default macro path).
		Edit the message groups and file groups for new settings.
		Run mbfile check to fix download directory permissions.
		Check the setting in menu 10.2.13 if it does what you want it
		to do.

	general:
		Added structures for area maintenance with area lists.
		Installing the maptabs don't give any errors anymore when
		installed as user mbse. The location of the source isn't
		important anymore to install the maptabs.
		Updated German, Spanish and Galego languages.
		The location of the sourcefiles is not important anymore.
		Added detection of vpopmail in default installation path.
		Changed language prompts 372, 373, 387, 388, 389, 390 and 438.
		Added the turbodiesel macro language so that reports can be
		customized per language and reports. Thanks to Redy Rodriguez
		for finding this one and implement it into mbse bbs.
		Splitted the No TCP settings in No IBN, No IFC and No ITN.
		Removed settings for Non-hold mail and Pickup Primary.
		Removed several setting for http setup, this is now handled
		by the macro templates.
		The rc files for joe, the external editor are now copied to
		/usr/lib/joe or /etc/joe depending on your distribution.
		Several readme files are now in a new html file, the FAQ.

	common.a:
		Added 2 functions to return the OS name and CPU family.
		Added a function to return the right tearline.
		Added support for ext3 filesystem in diskspace check.
		Fixed lharc archives return code to LHA.
		Changed mkprod.awk script to support Debian Woody.
		The aka2str function now onmits the @ if there is no domain
		information.

	clcomm.a
		Added counter for mailer TCP/IP sessions.

	diesel.a
		New library for parsing macro templates.

	msgbase.a:
		Improved logging for opening message bases.
		Added function to delete a JAM message base.
		Fix for corrupting LastRead pointers on FreeBSD systems.

	mbsetup:
		In message groups added default settings for auto area
		creation.
		Added servicename filemgr to the filemgr services.
		When adding or deleting a message area, several extra checks
		are done. The JAM base is also removed when deleting.
		Layout for message area editor changed, more logical now.
		If selecting a file/mailgroup in node edit that is outside the
		visible range of groups, the view is adjusted.
		If changing the path in an existing file area, the files in
		that area are moved to the new path.
		It is now possible to move file areas.
		It is now possible to move JAM message bases.
		Added edit of external message editor in menu 1.4.
		Added edit of NoPrompt setting in menus for doors.
		Changed edit of message editor in user editor.
		Double noderecords are automatic removed with error logging.
		Corrected screen layout in menu 1.4.11.
		When editing analogue modem lines, the locked portspeed was
		in a lot of cases set to 0.
		In newfiles and filefind reports sets default template files
		during init.
		When adding a new newfiles or filefind record some defaults
		are automatic filled in.
		Splitted no TCP into no IBN, no IFC and no ITN in global and
		nodes setup.
		When editing a new message area, and the area was made active,
		all entered data was erased.
		Removed setting for http setup which are now in the macro
		templates.
		Changed the screen layout of menu 10.2 a bit as suggested by
		Vince Coen.
		Fixed a non understandable logmessage in check if nodes are
		connected to file and or mail groups.
		It is now possible to reset a users time left for today.
		The top statusbar now displays the bbs Free/Down/Busy status.
		Some dangerous menus cannot be entered anymore while some
		programs are being used, ie. the bbs must be free. When these
		menus are entered, the bbs will be closed for use.
		Added menu 8.6, edit BBS list entries.
		Fixed numbering of menu 8.7, edit oneliners.
		Added menu 8.8 for safe crackers data. If the safe is cracked
		it can now be reset.
		Protected convert-all setting in menus 10.1 and 10.2 when no
		default archiver is defined.
		Changed page layout in site.doc
		Changed the confusing No Touch setting in tic areas to Touch.

	mbmon:
		The top statusbar now displays the bbs Free/Down/Busy status.
		Removed nonsense error message when stopped on a signal.

	mbfido:
		In AreaMgr and FileMgr changed aka matching for area 
		connections. Code cleanups.
		In FileMgr when %tick=on/off command was received, mbfido
		crashed.
		Implemented auto area create comparing a new received echo
		from a uplink which has a echomail taglist in one of the
		mailgroups defined. The area is created with the defaults
		from the mailgroup.
		If mbfido fails to unzip a incoming mailarchive, a second
		attempt is done after a sync() and one second delay. This
		seems to be a kernel flush problem.
		The same goes for adding .pkt files to the outbound, a second
		try is done after a sync() to add the .pkt to the archive.
		In the To field of a created TIC file there is now a comma
		between the sysop name and fidonet aka.
		When creating a filefind netmail reply there was no 
		destination address.
		Corrected spelling errors in the Areamgr and Filemgr help
		messages.
		Removed some debug logging from the RFC->FTN gate.
		Implemented the FileMgr and AreaMgr pause and resume commands.
		Changed logging when AreaMgr/FileMgr commands did fail.
		Some checks improved and fixed some potential sigsegv crashes.
		Reduced aka match level for (dis)connect areas to zone, net.
		This should fix problems on systems with multiple aka's when
		the first aka is not the aka in the areas.
		In mgr result reports, lines with connected areas do now also
		display the aka to which they are connected.
		The file forward function now always puts a 8.3 filename in
		the outgoing ticfile. For most files nothing is changed.
		AreaMgr and FileMgr netmails are now split into more netmails
		when the become too large.
		When a downlink requests an echomail area which is not yet 
		available, and there is a areas file for some uplink, the area
		is automatic created and a areamgr request is sent to the 
		uplink to connect that area. The area is created with the
		defaults from the mailgroup.
		Experimental patch in mkftnhdr to create a To address in news
		articles where a Reply-To: header is present.
		It was not possible to disconnect file areas.
		Added nopper code to full mailscan.
		Fixed a problem that caused a SIGSEGV when a node was in the
		ticfiles setup to forward file to and there was no noderecord.
		When a ticfile was received while our aka is in the path, the
		bad tic counter wasn't increased.
		Made error message in AddMsgHdr function more clear.
		Removed experimental patch in news->ftn gate were wrong To:
		address was created.
		The mbfido news functions doesn't abort anymore when a 
		newsgroup didn't exist.
		For points in echomail no seen-by entry is added.
		The AreaMgr and FileMgr responses and notify messages now use
		the diesel macro language.
		The tic file forward function now uses only filenames in the
		subject of the netmail messages without the path.
		The tic file forward netmails now uses template forward.tic
		When started a second time it doesn't destroy the lockfile
		anymore.
		When a converted email to news listserver message is processed
		that has a header line starting with X-MS-, the headerline is
		supressed because there is no key for this header. This looks
		like a new kind of M$ standard. mbnews crashed on this one.
		Fixed a small problem in magic filename testing.
		In rfc2ftn the Approved: header now becomes a kludge instead
		of being plain passed.
		Auto file area create implemented, it can use plain tagfiles
		or filegate.zxx formatted files.
		The mbfido web command now uses macro templates.
		Areamgr uplink requests the sender name is now set to the
		sysop's name, so he/she will get to read the responses.
		New command: areas. This will read all defined area lists for
		files and mail groups that have the Auto Change set to Yes.
		Missing areas are created, areas not present anymore are
		removed if they are empty. Good for bulk areas create.
		When missing areas are created, uplink requests are sent to
		connect the areas.
		Added more checks to processing of file_id.diz files. Also 
		when it is illegal formatted the already processed lines are
		cleared to prevent later malformatted descriptions.
		The hatch and magic processors now scan the filenames to test
		using the regexp library, this should be more reliable.
		Increased the size of the buffer for filesort.
		Improved error reporting when file copy fails.
		When a virus scanner is started, de mbtask connection timeout
                is set to one hour.
		Changed the confusing No Touch setting in tic areas to Touch.
		When a file to be attached doesn't exist, a error message is
		logged and the attach is treaded as an error.

	mbmsg:
		When creating non-existend message bases, the path is created
		first if it doesn't exist.
		Removed nonsense error message when stopped on a signal.

	mbfile:
		The mbfile index command now creates the html pages using the
		macro templates html.main and html.areas. The files.css file
		is no longer needed.
		The check function now checks download directory permissions
		and tries to correct errors.
		Missing download directories are created mode 0775.
		Moved check for empty areas to mbfile check function.
		The mbfile move command now also moves the thumbnails.
		Better console error reporting when files are copied.
		Removed nonsense error message when stopped on a signal.
		The html file indexes now have better translation from ANSI
		to low ascii and html codes.
		The import function didn't import files starting with the
		letter 't'.
		When a virus scanner is started, de mbtask connection timeout
		is set to one hour.
		The virus scanner was sometimes not executed in the right 
		directory with the adopt and import functions.

	mball:
		Will not crash anymore when it needs more then 10 minutes to
		create the allfiles and newfiles lists.
		Removed nonsense error message when stopped on a signal.

	mbaff:
		The High-ascii table to translate to lowercase has now the
		right values to translate the ansi graphics.
		Now uses the template newfiles and filefind to create the 
		reports.
		Removed nonsense error message when stopped on a signal.

	mbdiff:
		Removed nonsense error message when stopped on a signal.
		Improved error reporting when copy fails.

	mbindex:
		Removed nonsense error message when stopped on a signal.

	mbtask:
		Removed some debug logging.
		Creates the semafore is_inet when the internet connections is
		available, and removes it when it is down.
		Added test for ISDN/modem lines in use. If a line status 
		change lasted 5 seconds or longer, the oubound will be
		rescanned.
		Lots of code cleanup.
		No setup setting anymore for maximum POTS and ISDN lines, this
		is now automatic.
		mbtask will now update internal counters how many ISDN and POTS
		lines are free to use for dialout.
		For ISDN and POTS calls, mbtask now decides which tty to use,
		mbcico gets the tty to use as option on the commandline.
		Keeps track of the number of mailers running.
		Added default path for arealists.
		Keeps track of total mailer TCP/IP sessions and will not start
		new sessions if the limit from the setup is reached. This will
		hopefully prevent that mbcico will use too much bandwidth on
		TCP/IP trafic.
		Splitted no TCP settings in no IBN, no IFC and no ITN.
		Improved the ping tests, better errorlogging and suppresion of
		icmp replies that are not for mbtask. Better protected against
		flood pings. This should fixes the problem that the internet
		seemed down while it was available.

	mbcico:
		Fixed binkp driver to accept incoming unprotected sessions.
		If a binkp session comes in and there already is a session
		with that node, mbcico stopts the binkp session with an error.
		Remove some obsolete code that is handled by mbtask.
		Added some debug logmessages in ttyio.
		Added experimental support for binkp GET command frame, under
		test now, seems to work, although the offset request is not
		supported.
		Registers TCP/IP sessions with mbtask.
		All filetransfer times and cps rates are calculated in mSecs.
		Splitted no TCP settings in no IBN, no IFC and no ITN.
		Removed settings for Non-hold mail and Pickup Primary.
		Removed nonsense error message when stopped on a signal.
		Fixed some small problems with the history data log. Added tty
		information when it is available.

	mbout:
		The status display has now 9 digits for the outbound size.
		New command, mbout reset <node>, unconditionally resets the
		nodes "try" counter, ie. make an undiable node try to call 
		again.
		The status command displays the call attempts.
		Removed nonsense error message when stopped on a signal.

	mbsebbs:
		On some systems the download taglists contained garbage after
		the short filename causing wrong filenames at the users side.
		Added support for external message editor written by Redy.
		Doors are now passed the parameter to display a prompt after
		the door or return silently.
		Fixed lharc file return code to LHA.
		Calling file transfer protocols now uses the execute call
		instead of system.
		Improved error logging for file downloads.
		When a user has no Location filled in, the bbs doesn't crash
		anymore.
		The new files scan colored areasnames bar length is corrected.
		Fixed the problems with the safecracker door. Removed the
		cheat codes and added a delay for the display of the safe
		opening.
		Removed nonsense error message when stopped on a signal.

	mbnewusr:
		New users have the default internal fullscreen editor.
		Removed nonsense error message when stopped on a signal.

	mbuser:
		If a new user has registered and not yet used the bbs, mbuser
		would kill that user because the last login date wasn't set.
		It will use the registration date instead.

	mbstat:
		The timeout for the wait command was wrong due to a wrong
		upsdown semafore test.
		Corrected a spelling error.

	hatch:
		A new shellscript to hatch files in a tic area.

	mbuseradd:
		Added support for vpopmail, vadduser command.

	mbpasswd:
		Added support for vpopmail, vpasswd command.
		Corrected a define for temp variable.

	mbuser:
		Added support for vpopmail, vdeluser command.

	examples:
		The Makefile now selects the right little or big endian menu
		files to install.
		Rebuild the menus and txtfiles for the new external editor.
		Removed the mbsetup door from the sample sysop menus.
		Added templates.tar, these are the default english macro files
		for the diesel library.

	rundoor.sh
		Called door.bat instead of doors.bat

	installinit.sh
		Modified for SuSE 7.1 and later, the location of the startup
		script moved from /sbin to /etc. Patch by Joachim Kuwan.
		Also modified init.SuSE for Yast2 on SuSE 8.0

	mbse.stop:
		Added path /usr/local/bin for FreeBSD. Needs the psmisc 
		package from the ports collection to work.

	init.Debian
		Changed user from mbtask to mbse.

